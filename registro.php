<?phprequire 'admin/config.php';session_start();if(isset($_SESSION['usuario'])){    header('Location: index.php');}if($_SERVER['REQUEST_METHOD'] == 'POST'){    $nombre = $_POST['nombre'];    $apellido = $_POST['apellido'];    $mail = $_POST['mail'];    $usuario = filter_var(strtolower($_POST['usuario']), FILTER_SANITIZE_STRING);    $password = $_POST['clave'];    $password2 = $_POST['clave2'];    $tipo = $_POST['tipo_usuario'];    $errores = '';    if(empty($usuario) or empty($password) or empty($password2)){        $errores .= '<li>Por favor rellena todos los campos correctamente</li>';    }    else{        try{            $conexion = new PDO('mysql: host = localhost; dbname = mastergame', 'root', '');        }        catch(PDOException $e){            echo "Error: " . $e->getMessage();        }        $statement = $conexion->prepare('SELECT * FROM usuarios WHERE usuario = '.":usuario");        $statement->execute(array(':usuario' => $usuario));        $resultado = $statement->fetch();        if($resultado != false){            $errores .= '<li>El usuario ya existe!</li>';        }        $password = hash('sha512', $password);        $password2 = hash('sha512', $password2);        if($password != $password2){            $errores .= '<li>Las contraseñas no son iguales!</li>';        }    }    if($errores == ''){        $statement = $conexion->prepare('INSERT INTO mastergame.usuarios (nombre, apellido, mail, usuario, clave, tipo_usuario) VALUES (:nombre, :apellido, :mail, :usuario, :clave, :tipo_usuario)');        $statement->execute(array(            ':nombre' => $nombre,            ':apellido' => $apellido,            ':mail' => $mail,            ':usuario' => $usuario,            ':clave' => $password,            ':tipo_usuario' => 'cliente'        ));        header('Location: login.php');    }    else{        $errores .= '<li>Hubo un error muy grave! Contacte al soporte técnico.</li>';    }}require 'views/registro.view.php';?>